<div class="container">
    <div class="row">
        <div class="col">
            <form 
                #formRef="ngForm" 
                (ngSubmit)="submitForm(formRef.value)" 
                novalidate
            >
                <fieldset>
                    <legend class="font-weight-bold text-center">ID Collection Details</legend>

                    <div 
                        class="form-group" 
                        [class.has-success]="titleRef.valid && formSubmitted"
                        [class.has-danger]="titleRef.valid==false && titleRef.dirty && formSubmitted"
                    >
                        <label class="form-control-label font-weight-bold" for="title">Title</label>
                        <input 
                            [(ngModel)]="title"
                            [class.form-control-success]="titleRef.valid && formSubmitted"
                            [class.form-control-danger]="titleRef.valid==false && titleRef.dirty && formSubmitted"
                            #titleRef="ngModel" 
                            autocomplete="off"
                            class="form-control" 
                            id="title" 
                            minlength="4" 
                            name="title" 
                            placeholder="Write the collection title here..." 
                            type="text" 
                            required
                        >
                        <div 
                            *ngIf="titleRef.errors && titleRef.dirty && formSubmitted"
                            class="form-control-feedback" 
                        >
                            <small *ngIf="titleRef.errors?.required">This field is required</small >
                            <small *ngIf="titleRef.errors?.minlength">This field must be longer than {{titleRef.errors?.minlength.requiredLength}} characters. You only typed {{titleRef.errors?.minlength.actualLength}}</small >
                        </div>
                    </div>

                    <div 
                        class="form-group" 
                        [class.has-success]="descriptionRef.valid && formSubmitted"
                        [class.has-danger]="descriptionRef.valid==false && descriptionRef.dirty && formSubmitted"
                    >
                        <label class="form-control-label font-weight-bold" for="description">Description</label>
                        <textarea
                            [(ngModel)]="description"
                            [class.form-control-success]="descriptionRef.valid && formSubmitted"
                            [class.form-control-danger]="descriptionRef.valid==false && descriptionRef.dirty && formSubmitted"
                            #descriptionRef="ngModel" 
                            class="form-control" 
                            id="description" 
                            minlength="4" 
                            name="description" 
                            placeholder="Write the collection description here..." 
                            required
                            rows="5"
                        ></textarea> 
                        <div 
                            *ngIf="descriptionRef.errors && descriptionRef.dirty && formSubmitted"
                            class="form-control-feedback" 
                        >
                            <small *ngIf="descriptionRef.errors?.required">This field is required</small >
                            <small *ngIf="descriptionRef.errors?.minlength">This field must be longer than {{descriptionRef.errors?.minlength.requiredLength}} characters. You only typed {{descriptionRef.errors?.minlength.actualLength}}</small >
                        </div>
                    </div>
                    <div
                        *ngIf="username || uri" 
                        class="form-group"
                    >
                        <p class="form-control-label font-weight-bold">
                            Created by
                        </p>
                        <p><span *ngIf="username">{{username}}, </span><a href="{{fullOrcidId}}" target="_blank">{{orcid}}</a></p>
                    </div>
                    <div class="form-group">
                        <p>
                        
                            <button 
                                [disabled]="!formRef.valid"
                                class="btn btn-primary" 
                                type="submit" 
                                role="button"
                            >
                                Save Details
                            </button>    
                            <span (click)="showErrorMessage = !showErrorMessage" *ngIf="showErrorMessage" class="text-danger ml-3"><strong>Oh snap!</strong> Change a few things up and try submitting again.</span>
                            <span (click)="showSuccessMessage = !showSuccessMessage" *ngIf="showSuccessMessage" class="text-success ml-3"><strong>Well done!</strong> You successfully added a collection.</span>
                        </p>                            
                    </div>
                </fieldset>
            </form>
        </div>
    </div>
    <div 
        *ngIf="formSubmitted || !formEmptyOnLoad"
        class="row"
    >
        <div class="col">
            <div class="card">
                <div class="card-block">
                    <h2>Collection Links <small>Hold onto these!</small></h2>
                    <h3>Administration Link</h3>
                    <p>Use this link to edit collection details:</p>
                    <p><a href="{{windowLocationOrigin}}/{{publicKey}}/edit/{{privateKey}}">{{windowLocationOrigin}}/{{publicKey}}/edit/{{privateKey}} <fa name="clipboard"></fa></a></p>
                    <h3>Share Link</h3>
                    <p>Share this link with anyone whose iD you want to collect, or display this page on a laptop/tablet at your event:</p>
                    <p><a href="{{windowLocationOrigin}}/{{publicKey}}" target="_{{publicKey}}">{{windowLocationOrigin}}/{{publicKey}} <fa name="external-link-square"></fa></a></p>
                </div>
            </div>
        </div>
    </div>
</div>